<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              out1nel.f
         using $CLAW/doc/clawcode2html.py         -->

<html>
<title> out1nel.f.html </title>


           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/ketch/Research/Projects/periodicshock/shockdata/out1nel.f -->
<!-- Date: Tue Feb 15 2011 at 10:15:26 -->

<table bgcolor="#FFEE99"> <tr> <td>
<tr> <td><a href="http://www.clawpack.org"><img
            src="http://localhost:50005/doc/images/clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=6> out1nel.f.html </font>
            </td><td>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="out1nel.f">out1nel.f </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/ketch/Research/Projects/periodicshock/shockdata 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Tue Feb 15 2011 at 10:15:26 
&nbsp; using <a href="http://localhost:50005/doc/clawcode2html.html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 
<font color="blue">c =========================================================</font>
      subroutine output(meqn,mbc,mx,xlower,dx,q,t,iframe,aux,maux)
<font color="blue">c =========================================================</font>
<font color="blue">c</font>
<font color="blue">c     # Output the results for a general system of conservation laws</font>
<font color="blue">c     # in 1 dimension</font>
<font color="blue">c</font>
      implicit double precision (a-h,o-z)
      parameter (ndim=1)
      dimension q(1-mbc:mx+mbc, meqn)
      dimension aux(1-mbc:mx+mbc, 3)
      character*10 fname1, fname2, fname3
      logical outaux

      outaux = .false.
<font color="blue">c</font>
<font color="blue">c     # Write the results to the file fort.q<iframe></font>
<font color="blue">c     # Use format required by matlab script  plotclaw1.m</font>
<font color="blue">c     # The same format is used by the amrclaw package.  </font>
<font color="blue">c     # Here it's adapted to output just the single grid.</font>
<font color="blue">c</font>
<font color="blue">c     # first create the file name and open file</font>
<font color="blue">c</font>
         fname1 = 'fort.qxxxx'
         fname2 = 'fort.txxxx'
         fname3 = 'fort.axxxx'
         nstp = iframe
         do 55 ipos = 10, 7, -1
            idigit = mod(nstp,10)
            fname1(ipos:ipos) = char(ichar('0') + idigit)
            fname2(ipos:ipos) = char(ichar('0') + idigit)
            fname3(ipos:ipos) = char(ichar('0') + idigit)
            nstp = nstp / 10
 55      continue

         open(unit=50,file=fname1,status='unknown',form='formatted')
         open(unit=60,file=fname2,status='unknown',form='formatted')

<font color="blue">c</font>
<font color="blue">c     # the following parameters are used in amrclaw where there are</font>
<font color="blue">c     # multiple grids.  Here they are all set to 1:</font>
      ngrids = 1
      mptr = 1
      level = 1

      write(50,1001) mptr,level,mx
 1001 format(i5,'                 grid_number',/,
     &       i5,'                 AMR_level',/,
     &       i5,'                 mx')

      write(50,1002) xlower,dx
 1002 format(e18.8,'    xlow', /,
     &       e18.8,'    dx', /)
<font color="blue">c</font>
<font color="blue">c       do 10 i=1-mbc,mx+mbc</font>
        do 10 i=1,mx
          do m=1,meqn
<font color="blue">c            # exponents with more than 2 digits cause problems reading</font>
<font color="blue">c            # into matlab... reset tiny values to zero:</font>
             if (dabs(q(i,m)) .lt. 1d-90) q(i,m) = 0.d0
             enddo
<font color="blue">c</font>
          sig = sigma(q(i,1),i,aux(i,2),aux(i,3))
          u = q(i,2)/aux(i,1)
<font color="blue">c          write(50,1005) (q(i,m), m=1,meqn),sig,u</font>
          write(50,1005) sig,u
 1005     format(4e32.16)
<font color="blue">c</font>
 10       continue
        write(50,*) ' '
 20     continue
      write(50,*) ' '

<font color="blue">c      write(60,1000) t,meqn+2,ngrids,ndim,maux</font>
      write(60,1000) t,meqn,ngrids,maux,1
 1000 format(e18.8,'    time', /, 
     &       i5,'                 meqn'/,
     &       i5,'                 ngrids'/,
     &       i5,'                 maux'/,
     &       i5,'                 ndim'/,/)
<font color="blue">c</font>

      close(unit=50)
      close(unit=60)

      return
      end
</pre></html>
