<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              bc1.f
         using $CLAW/doc/clawcode2html.py         -->

<html>
<title> bc1.f.html </title>


           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/ketch/Research/Projects/periodicshock/shockdata/bc1.f -->
<!-- Date: Tue Feb 15 2011 at 10:15:26 -->

<table bgcolor="#FFEE99"> <tr> <td>
<tr> <td><a href="http://www.clawpack.org"><img
            src="http://localhost:50005/doc/images/clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=6> bc1.f.html </font>
            </td><td>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="bc1.f">bc1.f </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/ketch/Research/Projects/periodicshock/shockdata 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Tue Feb 15 2011 at 10:15:26 
&nbsp; using <a href="http://localhost:50005/doc/clawcode2html.html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 

<font color="blue">c</font>
<font color="blue">c</font>
<font color="blue">c     =================================================================</font>
      subroutine bc(maxmx,meqn,mbc,mx,xlower,dx,q,maux,aux,t,dt,mthbc)
<font color="blue">c     =================================================================</font>
<font color="blue">c</font>
<font color="blue">c     # Standard boundary condition choices for claw2</font>
<font color="blue">c</font>
<font color="blue">c     # At each boundary  k = 1 (left),  2 (right):</font>
<font color="blue">c     #   mthbc(k) =  0  for user-supplied BC's (must be inserted!)</font>
<font color="blue">c     #            =  1  for zero-order extrapolation</font>
<font color="blue">c     #            =  2  for periodic boundary coniditions</font>
<font color="blue">c     #            =  3  for solid walls, assuming this can be implemented</font>
<font color="blue">c     #                  by reflecting the data about the boundary and then</font>
<font color="blue">c     #                  negating the 2'nd component of q.</font>
<font color="blue">c     ------------------------------------------------</font>
<font color="blue">c</font>
<font color="blue">c     # Extend the data from the computational region</font>
<font color="blue">c     #      i = 1, 2, ..., mx2</font>
<font color="blue">c     # to the virtual cells outside the region, with</font>
<font color="blue">c     #      i = 1-ibc  and   i = mx+ibc   for ibc=1,...,mbc</font>
<font color="blue">c</font>
      implicit double precision (a-h,o-z)
      dimension q(1-mbc:maxmx+mbc, meqn)
      dimension aux(1-mbc:maxmx+mbc, *)

      dimension mthbc(2)
      common /comwall/ pi,t1,a1,tw1

<font color="blue">c</font>
<font color="blue">c     # switch to periodic boundary conditions once pulse is generated:</font>
      if (t .gt. 5.*tw1 .and. t .lt. 5.*tw1+1.d0) then
         mthbc(1) = 2
         mthbc(2) = 2
         endif
      if (mthbc(1).eq.2) then
         do ibc=1,mbc
            aux(1-ibc,1) = aux(mx+1-ibc,1)
            aux(1-ibc,2) = aux(mx+1-ibc,2)
            aux(1-ibc,3) = aux(mx+1-ibc,3)
            aux(mx+ibc,1) = aux(ibc,1)
            aux(mx+ibc,2) = aux(ibc,2)
            aux(mx+ibc,3) = aux(ibc,3)
         enddo
      endif
     
<font color="blue">c</font>
<font color="blue">c-------------------------------------------------------</font>
<font color="blue">c     # left boundary:</font>
<font color="blue">c-------------------------------------------------------</font>
      go to (100,110,120,130) mthbc(1)+1
<font color="blue">c</font>
  100 continue
<font color="blue">c     # user-specified boundary conditions </font>
<font color="blue">c     # oscillating wall </font>
      do 105 m=1,meqn
         do 105 ibc=1,mbc
               q(1-ibc,m) = q(ibc,m)
  105       continue
<font color="blue">c     # wall velocity:  (make negative for expansion)</font>
      vwall = -a1*g0((t-t1)/tw1)
<font color="blue">c     # adjust the normal momentum:</font>
      do 106 ibc=1,mbc
            q(1-ibc,2) = 2.0d0*vwall*aux(ibc,1) - q(ibc,2)
  106    continue
      go to 199
<font color="blue">c</font>
  110 continue
<font color="blue">c     # zero-order extrapolation:</font>
      do 115 m=1,meqn
         do 115 ibc=1,mbc
               q(1-ibc,m) = q(1,m)
  115       continue
      go to 199

  120 continue
<font color="blue">c     # periodic:  </font>
      do 125 m=1,meqn
         do 125 ibc=1,mbc
               q(1-ibc,m) = q(mx+1-ibc,m)
  125       continue
      go to 199

  130 continue
<font color="blue">c     # solid wall (assumes 2'nd component is velocity or momentum in x):</font>
      do 135 m=1,meqn
         do 135 ibc=1,mbc
               q(1-ibc,m) = q(ibc,m)
  135       continue
<font color="blue">c     # negate the normal velocity:</font>
      do 136 ibc=1,mbc
            q(1-ibc,2) = -q(ibc,2)
  136    continue
      go to 199

  199 continue

<font color="blue">c</font>
<font color="blue">c-------------------------------------------------------</font>
<font color="blue">c     # right boundary:</font>
<font color="blue">c-------------------------------------------------------</font>
      go to (200,210,220,230) mthbc(2)+1
<font color="blue">c</font>
  200 continue
<font color="blue">c     # user-specified boundary conditions </font>
<font color="blue">c     # oscillating wall </font>
      do 205 m=1,meqn
         do 205 ibc=1,mbc
	       q(mx+ibc,m) = q(mx+1-ibc,m)
  205       continue
<font color="blue">c     # wall velocity:</font>
      vwall = a2*g0((t-t2)/tw2)
<font color="blue">c     # adjust the normal velocity:</font>
      do 206 ibc=1,mbc
         q(mx+ibc,2) = 2.0d0*vwall*aux(mx+1-ibc,1) - q(mx+1-ibc,2)
  206    continue
      go to 299

  210 continue
<font color="blue">c     # zero-order extrapolation:</font>
      do 215 m=1,meqn
         do 215 ibc=1,mbc
               q(mx+ibc,m) = q(mx,m)
  215       continue
      go to 299

  220 continue
<font color="blue">c     # periodic:  </font>
      do 225 m=1,meqn
         do 225 ibc=1,mbc
               q(mx+ibc,m) = q(ibc,m)
  225       continue
      go to 299

  230 continue
<font color="blue">c     # solid wall (assumes 2'nd component is velocity or momentum in x):</font>
      do 235 m=1,meqn
         do 235 ibc=1,mbc
               q(mx+ibc,m) = q(mx+1-ibc,m)
  235       continue
      do 236 ibc=1,mbc
            q(mx+ibc,2) = -q(mx+1-ibc,2)
  236    continue
      go to 299

  299 continue
<font color="blue">c</font>
      return
      end


<font color="blue">c     ===============================</font>
      double precision function g0(t)
<font color="blue">c     ===============================</font>

      implicit double precision (a-h,o-z)
      common /comwall/ pi,t1,a1,tw1

      if (dabs(t) .lt. 1.d0)  then
	  g0 = 1.d0 + dcos(pi*t)
	else
	  g0 = 0.d0
	endif

      return
      end

</pre></html>
