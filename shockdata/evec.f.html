<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              evec.f
         using $CLAW/doc/clawcode2html.py         -->

<html>
<title> evec.f.html </title>


           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/ketch/Research/Projects/periodicshock/shockdata/evec.f -->
<!-- Date: Tue Feb 15 2011 at 10:15:26 -->

<table bgcolor="#FFEE99"> <tr> <td>
<tr> <td><a href="http://www.clawpack.org"><img
            src="http://localhost:50005/doc/images/clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=6> evec.f.html </font>
            </td><td>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="evec.f">evec.f </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/ketch/Research/Projects/periodicshock/shockdata 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Tue Feb 15 2011 at 10:15:26 
&nbsp; using <a href="http://localhost:50005/doc/clawcode2html.html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 
<font color="blue">c</font>
<font color="blue">c</font>
<font color="blue">c     =====================================================</font>
      subroutine evec(maxm,meqn,mbc,mx,q,auxl,auxr,evl,evr)
<font color="blue">c     =====================================================</font>
<font color="blue">c</font>
<font color="blue">c     # Calculation of left and right eigenvectors</font>
<font color="blue">c     # for the nonlinear elastic equations in 1d, with</font>
<font color="blue">c     #  variable coefficients</font>
<font color="blue">c</font>
<font color="blue">c     # aux(i,1) = rho(i)</font>
<font color="blue">c</font>
<font color="blue">c     # function sigma(eps,i) gives stress-strain relation in i'th cell</font>
<font color="blue">c     # function sigmap(eps,i) gives d/(d eps) of sigma</font>
<font color="blue">c     #    For linear:   sigma(eps,i) = K_i * eps, and sigmap(eps,i) = K_i</font>

<font color="blue">c     # On input, q contains the state vector in each cell</font>
<font color="blue">c</font>
<font color="blue">c     # On output, evl(i) and evr(i) contain left/right eigenvectors</font>
<font color="blue">c     # at interface i-1/2</font>
<font color="blue">c</font>
<font color="blue">c</font>
      implicit double precision (a-h,o-z)
<font color="blue">c</font>
      dimension  auxl(1-mbc:maxm+mbc, 2)
      dimension  auxr(1-mbc:maxm+mbc, 2)
      dimension  q(1-mbc:maxm+mbc, meqn)
      dimension evl(1-mbc:maxm+mbc,meqn,meqn)
      dimension evr(1-mbc:maxm+mbc,meqn,meqn)
<font color="blue">c</font>
      do 20 i = 2-mbc, mx+mbc
         rhoi = auxl(i,1)
         rhoim = auxr(i-1,1)
         epsi = q(i,1)
         epsim = q(i-1,1)
         urhoi = q(i,2)
         urhoim = q(i-1,2)
                  
<font color="blue">c #linearize on each side:</font>

         bulki = sigmap(epsi,i)
         bulkim = sigmap(epsim,i-1)
         ci = dsqrt(bulki / rhoi)
         cim = dsqrt(bulkim / rhoim)
         zi = ci*rhoi
         zim = cim*rhoim

<font color="blue">c  Right eigenvector matrix</font>
<font color="blue">c        1      1</font>
<font color="blue">c R =</font>
<font color="blue">c        Z_i-1  -Z_i</font>

         evl(i,1,1) = 1.d0
         evl(i,1,2) = 1.d0
         evl(i,2,1) = zim
         evl(i,2,2) = -zi

<font color="blue">c  Left eigenvector matrix</font>
         zh=1.d0/(zim+zi);

         evr(i,1,1) = zi*zh
         evr(i,1,2) = zh
         evr(i,2,1) = zim*zh
         evr(i,2,2) = -zh
   20    continue

      return
      end
</pre></html>
