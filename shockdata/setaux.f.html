<!-- **** DO NOT EDIT THIS FILE *** 
         This file was generated automatically from file
              setaux.f
         using $CLAW/doc/clawcode2html.py         -->

<html>
<title> setaux.f.html </title>


           <BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000FF" 
                 VLINK="#5500DD" ALINK="#FF0000">
           <font FACE="HELVETICA,ARIAL">
           
<!-- Created from the file /Users/ketch/Research/Projects/periodicshock/shockdata/setaux.f -->
<!-- Date: Tue Feb 15 2011 at 10:15:27 -->

<table bgcolor="#FFEE99"> <tr> <td>
<tr> <td><a href="http://www.clawpack.org"><img
            src="http://localhost:50005/doc/images/clawlogo.jpg"
            width=100 alt="CLAWPACK"></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=6> setaux.f.html </font>
            </td><td>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; </td> </tr> <tr> <td>
&nbsp;Source file: &nbsp;&nbsp;<a href="setaux.f">setaux.f </a>
</td></tr><tr><td>
&nbsp;Directory:  &nbsp; /Users/ketch/Research/Projects/periodicshock/shockdata 
</td></tr><tr><td>
&nbsp;Converted:  &nbsp; Tue Feb 15 2011 at 10:15:27 
&nbsp; using <a href="http://localhost:50005/doc/clawcode2html.html">clawcode2html</a>
</td></tr><tr><td>
<font color="#BB3300"> &nbsp;This documentation file will 
not reflect any later changes in the source file. </font>
</td></tr></table></font>
<p>
<pre> 
<font color="blue">!     ============================================</font>
      subroutine setaux(maxmx,mbc,mx,xlower,dx,maux,aux)
<font color="blue">!     ============================================</font>
<font color="blue">!</font>
<font color="blue">!     # set auxiliary arrays </font>
<font color="blue">!     # variable coefficient acoustics</font>
<font color="blue">!     #  aux(i,1) = rho in ith cell</font>
<font color="blue">!     #  aux(i,2) = coefA (nonlinear bulk modulus)</font>
<font color="blue">!     #  aux(i,3) = coefB (linear bulk modulus)</font>
<font color="blue">!</font>
<font color="blue">!     # rho value for i-1 < x < i is determined by rho(i)</font>
<font color="blue">!     # input from setprob.rho in setprob.f</font>
<font color="blue">!</font>
<font color="blue">!     </font>
<font color="blue">!     TODO:</font>
<font color="blue">!       - Add capability for many layers</font>
<font color="blue">!       - Add smoothly varying media as run-time option</font>

      implicit double precision (a-h,o-z)
      dimension aux(1-mbc:maxmx+mbc, 3)
      common /commat/ dKA, dKB, rhoA, rhoB

      open(unit=31,file='fort.aux',status='unknown',form='formatted')
<font color="blue">!</font>

       pi = datan(1.d0)*4.d0
       xupper = xlower + mx*dx
       do 100 i=1-mbc,mx+mbc
          xcell = xlower + (i-0.5d0)*dx
<font color="blue">!</font>
<font color="blue">!         # discrete layers:</font>
<font color="blue">!         # layer A between j and j+frac1</font>
<font color="blue">!         # layer B between j+frac1 and j+1</font>

          frac1 = 1.d0/2.d0
          frac2 = 3.d0/2.d0
          frac3 = 3.d0/2.d0

          ix = xcell
          xfrac = xcell - ix
          if (xfrac .lt. frac1) then
<font color="blue">!     &          .and.xcell .lt. (xupper-xlower)*0.5d0) then</font>
<font color="blue">!             # layer A:</font>
              aux(i,1) = rhoA
              aux(i,2) = dKA
              aux(i,3) = 0.d0
            elseif (xfrac .lt. frac2) then
<font color="blue">!     &         .and. xcell .lt. (xupper-xlower)*0.5d0) then</font>
<font color="blue">!             # layer B:</font>
              aux(i,1) = rhoB
              aux(i,2) = dKB
              aux(i,3) = 0.0d0
<font color="blue">!           elseif (xfrac .lt. frac3) then</font>
<font color="blue">!             aux(i,1) = 2.0d0</font>
<font color="blue">!             aux(i,2) = 0.d0</font>
<font color="blue">!             aux(i,3) = 2.0d0</font>
<font color="blue">!            else</font>
<font color="blue">!             # linear material</font>
<font color="blue">!              aux(i,1) = 10.0d0</font>
<font color="blue">!              aux(i,2) = 0.d0</font>
<font color="blue">!              aux(i,3) = 10.d0</font>
            endif

<font color="blue">!         For sinotons:</font>
<font color="blue">!         aux(i,1)=2.5d0+1.5d0*(dsin(2.d0*pi*xcell))**1.d0</font>
<font color="blue">!         aux(i,2)=2.5d0+1.5d0*(dsin(2.d0*pi*(xcell+0.0d0)))**1.d0</font>
<font color="blue">!         aux(i,3)=0.d0</font>
  100     continue

<font color="blue">!      # make material uniform in ghost cells:</font>
       do ibc=1,mbc
          aux(1-ibc,1) = aux(1,1)
          aux(mx+ibc,1) = aux(mx,1)
          aux(1-ibc,2) = aux(1,2)
          aux(mx+ibc,2) = aux(mx,2)
          aux(1-ibc,3) = aux(1,3)
          aux(mx+ibc,3) = aux(mx,3)
          enddo

	do i=1,mx
          write(31,701) aux(i,1),aux(i,2),aux(i,3)
  701     format(3e16.6)
          enddo

       close(unit=31)
<font color="blue">!</font>
       return
       end
</pre></html>
